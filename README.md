# RiverAI ü§ñ

**–ò–ò-–ê—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è –†–µ–ø–µ—Ç–∏—Ç–æ—Ä–∞ –≤ Telegram**

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä—É—Ç–∏–Ω–Ω—ã—Ö –∑–∞–¥–∞—á —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä–æ–≤: –≤–µ–¥–µ–Ω–∏—è –±–∞–∑—ã —É—á–µ–Ω–∏–∫–æ–≤, –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —É—á–µ–±–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ —Å –ø–æ–º–æ—â—å—é –ò–ò, –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ–º–∞—à–Ω–∏—Ö —Ä–∞–±–æ—Ç –∏ –æ–±—â–µ–Ω–∏—è —Å GPT –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ —É—á–µ–Ω–∏–∫–∞.

---

## üéØ –¶–µ–ª—å –∏ –∞—É–¥–∏—Ç–æ—Ä–∏—è

* **–¶–µ–ª—å:** –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—é –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —ç–∫–æ–Ω–æ–º—è—â–∏–π –≤—Ä–µ–º—è –Ω–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏ –∞–Ω–∞–ª–∏–∑ –¥–æ–º–∞—à–Ω–∏—Ö —Ä–∞–±–æ—Ç. –ë–æ—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —É—á–µ–±–Ω—ã–µ –ø–ª–∞–Ω—ã –∏ –∑–∞–¥–∞–Ω–∏—è, –ø–æ–ª—É—á–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ä–µ—à–µ–Ω–∏–π —Å –ø–æ—è—Å–Ω–µ–Ω–∏—è–º–∏ –∏ –≤–µ—Å—Ç–∏ –¥–∏–∞–ª–æ–≥ —Å –ò–ò.
* **–ê—É–¥–∏—Ç–æ—Ä–∏—è:** —á–∞—Å—Ç–Ω—ã–µ —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä—ã –∏ –Ω–µ–±–æ–ª—å—à–∏–µ —É—á–µ–±–Ω—ã–µ —Ü–µ–Ω—Ç—Ä—ã, —Å—Ç—Ä–µ–º—è—â–∏–µ—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏ —É–ø—Ä–æ—Å—Ç–∏—Ç—å –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É –∫ –∑–∞–Ω—è—Ç–∏—è–º.

---

## ‚ú® –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

1. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á–µ–Ω–∏–∫–∞–º–∏**

   * –î–æ–±–∞–≤–ª–µ–Ω–∏–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–π (–∏–º—è, –ø—Ä–µ–¥–º–µ—Ç, —É—Ä–æ–≤–µ–Ω—å, –∑–∞–º–µ—Ç–∫–∏).
2. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É—á–µ–±–Ω–æ–≥–æ –ø–ª–∞–Ω–∞**

   * –ü–æ –æ–ø–∏—Å–∞–Ω–∏—é —Ç–µ–º—ã —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥—Ä–æ–±–Ω—ã–π –ø–ª–∞–Ω.
   * –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ —Ç–µ–∫—Å—Ç–æ–≤–æ–º –∏–ª–∏ PDF —Ñ–æ—Ä–º–∞—Ç–µ –Ω–∞ –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫–µ.
3. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–¥–∞–Ω–∏–π**

   * –°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞–±–æ—Ä–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –ø–æ —Ç–µ–º–µ.
   * –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ—à–µ–Ω–∏–π –≤ PDF –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ —É—á–µ–Ω–∏–∫—É.
4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è**

   * –ê–Ω–∞–ª–∏–∑ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ —Å —Ä–µ—à–µ–Ω–∏–µ–º —É—á–µ–Ω–∏–∫–∞ —á–µ—Ä–µ–∑ GPT.
   * –û—Ç—á—ë—Ç —Å –æ—à–∏–±–∫–∞–º–∏, –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –æ—Ç–≤–µ—Ç–∞–º–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏.
   * –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç—á—ë—Ç–∞ –Ω–∞ –Ø.–î–∏—Å–∫–µ.
5. **–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π —á–∞—Ç —Å GPT**

   * –î–∏–∞–ª–æ–≥ –æ—Ç –ª–∏—Ü–∞ —É—á–µ–Ω–∏–∫–∞ –∏–ª–∏ —Å —É—á—ë—Ç–æ–º –µ–≥–æ —É—Ä–æ–≤–Ω—è.
   * –•—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 10 —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.
6. **–ü–æ–¥–ø–∏—Å–∫–∏ –∏ –ª–∏–º–∏—Ç—ã**

   * –ë–∞–∑–æ–≤—ã–π —Ç–∞—Ä–∏—Ñ: \~200 –ò–ò-–∑–∞–ø—Ä–æ—Å–æ–≤/–º–µ—Å.
   * –ü—Ä–µ–º–∏—É–º: \~1000 –∏–ª–∏ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.
   * –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Å—Ç–∞–≤—à–µ–≥–æ—Å—è –ª–∏–º–∏—Ç–∞ –∏ –∏—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π.
7. **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**

   * –°–º–µ–Ω–∞ –∏–º–µ–Ω–∏ –ø—Ä–æ—Ñ–∏–ª—è, —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—Ä–æ–ª—è (bcrypt), —è–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (RU/EN).
   * –ü—Ä–∏–≤—è–∑–∫–∞ –Ø–Ω–¥–µ–∫—Å.–î–∏—Å–∫–∞, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ–∫–æ–Ω—á–∞–Ω–∏–∏ –ø–æ–¥–ø–∏—Å–∫–∏ –∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –æ—Ç—á—ë—Ç–æ–≤.

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

![Architecture](architecture.png)

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

* **Bot Application** (Python, Aiogram 3)

  * –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç Telegram (webhook/polling).
  * –ü—É–±–ª–∏–∫—É–µ—Ç –∑–∞–¥–∞—á–∏ –≤ RabbitMQ, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ FSM –≤ Redis.
* **Queue & State**

  * **RabbitMQ:** task\_queue –∏ result\_queue.
  * **Redis:** —Ö—Ä–∞–Ω–µ–Ω–∏–µ FSM –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–∏–∞–ª–æ–≥–∞.
* **Workers** (Python, asyncio)

  * –°–ª—É—à–∞—é—Ç task\_queue, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –∑–∞–¥–∞—á–∏ (OpenAI API, LaTeX, –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –æ–±–ª–∞–∫–æ).
  * –û—Ç–ø—Ä–∞–≤–ª—è—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ result\_queue.
* **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** (PostgreSQL)

  * –û—Å–Ω–æ–≤–Ω–∞—è –∏ —Ä–µ–ø–ª–∏–∫–∞ (Hot Standby).
  * –•—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–π, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏, –ø–æ–¥–ø–∏—Å–æ–∫ –∏ –ª–æ–≥–æ–≤.

**–û—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:**

* –†–µ–∑–µ—Ä–≤–Ω—ã–π –±–æ—Ç-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ –¥—Ä—É–≥–æ–º –¥–∞—Ç–∞—Ü–µ–Ω—Ç—Ä–µ.
* –†–µ–ø–ª–∏–∫–∞—Ü–∏—è –ë–î –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å promote —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –≤ –º–∞—Å—Ç–µ—Ä.
* –ò–∑–±—ã—Ç–æ—á–Ω–æ—Å—Ç—å –≤–æ—Ä–∫–µ—Ä–æ–≤ –∏ –∑–µ—Ä–∫–∞–ª–∏—Ä–æ–≤–∞–Ω–∏–µ RabbitMQ.

---

## üöÄ –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –∏ –∑–∞–ø—É—Å–∫

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/your-repo/RiverAI.git
cd RiverAI
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

* –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –ø–æ —à–∞–±–ª–æ–Ω—É.
* –ó–∞–ø–æ–ª–Ω–∏—Ç–µ: `TELEGRAM_TOKEN`, `DB_HOST`, `RABBITMQ_HOST`, `REDIS_HOST`, `OPENAI_KEYS` –∏ –¥—Ä.

### 3. –ó–∞–ø—É—Å–∫ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –æ—á–µ—Ä–µ–¥–µ–π

```bash
cd infrastructure/queue/
./deploy.sh
```

### 4. –ó–∞–ø—É—Å–∫ PostgreSQL (Primary)

```bash
docker run -d --name postgres-main \
  -e POSTGRES_DB=tutorbot_db -e POSTGRES_USER=tutorbot -e POSTGRES_PASSWORD=... \
  -p 5432:5432 postgres:14
```

### 5. –ó–∞–ø—É—Å–∫ PostgreSQL (Replica)

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ streaming replication –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker Bitnami –æ–±—Ä–∞–∑.

### 6. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

```bash
cd infrastructure/bot/
./deploy.sh
```

### 7. –ó–∞–ø—É—Å–∫ –≤–æ—Ä–∫–µ—Ä–æ–≤

```bash
cd infrastructure/worker1-2/
./deploy.sh
# –ò –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –Ω–∞ –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö
```

### 8. Telegram Webhook

* –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —á–µ—Ä–µ–∑ BotFather –∏–ª–∏ API Telegram.

### 9. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

* –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start` –≤ –±–æ—Ç–µ.
* –î–æ–±–∞–≤—å—Ç–µ —É—á–µ–Ω–∏–∫–∞ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –ø–ª–∞–Ω–∞.

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

* **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** (AES-256 EAX): —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –∏ OAuth-—Ç–æ–∫–µ–Ω—ã.
* **–•—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π** (bcrypt).
* **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** –ø–æ Telegram ID –±–µ–∑ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏.
* **–ò–∑–æ–ª—è—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤**: –≤—Å–µ –∫–ª—é—á–∏ –≤ `.env`, –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞.
* **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è Docker**: –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ —Å–µ—Ç–∏, –æ—Ç–∫—Ä—ã—Ç—ã —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –ø–æ—Ä—Ç—ã.

---

